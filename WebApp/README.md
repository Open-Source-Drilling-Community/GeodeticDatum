# WebApp — Geodetic Datum UI (Blazor Server)

A Blazor Server UI for interacting with the GeodeticDatum Service. It lets users browse and edit spheroids and geodetic datums, perform conversions between WGS84 and regional datums, and inspect basic usage statistics.

Base path: `/GeodeticDatum/webapp` (see `WebApp/Program.cs`).

Container image name: `norcedrillinggeodeticdatumwebappclient`.

## Purpose in the Solution

- Provides a user-friendly interface over the Service REST API.
- Uses the generated client from `ModelSharedOut` for type-safe API calls.
- Leverages MudBlazor and domain-specific unit components for data entry and visualization.

## Installation

Prerequisites:
- .NET 8 SDK
- Optional: Docker

Configure endpoints (choose one):
- App settings: edit `WebApp/appsettings.Development.json` or `WebApp/appsettings.json` keys:
  - `GeodeticDatumHostURL`: e.g., `https://dev.digiwells.no/`
  - `UnitConversionHostURL`: e.g., `https://dev.digiwells.no/`
- Environment variables at run-time:
  - `GeodeticDatumHostURL`
  - `UnitConversionHostURL`

Local run:
- From repo root: `dotnet build` then `dotnet run --project WebApp/WebApp.csproj`
- Open `http://localhost:<port>/GeodeticDatum/webapp`

Docker build/run:
- Build: `docker build -t norcedrillinggeodeticdatumwebappclient WebApp`
- Run: `docker run -p 8081:8080 -e ASPNETCORE_URLS=http://+:8080 -e GeodeticDatumHostURL=https://dev.digiwells.no/ -e UnitConversionHostURL=https://dev.digiwells.no/ norcedrillinggeodeticdatumwebappclient`
- Open `http://localhost:8081/GeodeticDatum/webapp`

Kubernetes (Helm):
- Charts located under `WebApp/charts/norcedrillinggeodeticdatumwebappclient` with ingress templates. Ensure ingress path matches `/GeodeticDatum/webapp`.

## Usage

Navigation (see `WebApp/Pages`):
- `Spheroid` (`/Spheroid`): list, add, edit, and delete spheroids.
- `GeodeticDatum` (`/GeodeticDatum`): list, add, edit, and delete datums.
- `GeodeticConverter` (`/GeodeticConverter`): convert WGS84 ↔ datum using the API’s batch conversion.
- `Statistics` (`/Statistics`): view usage stats.

Example: convert WGS84 to a target datum in the UI
- Go to `/GeodeticConverter`
- Enter latitude/longitude (sexagesimal or decimal) and TVD (Vertical Depth), pick a target datum, click Convert.
- Results populate read-only fields; conversion uses `POST /GeodeticDatum/api/GeodeticConversionSet` under the hood.

## Dependencies

Internal:
- `ModelSharedOut`: provides the generated OpenAPI client (`NORCE.Drilling.GeodeticDatum.ModelShared.*`) used in `Shared/APIUtils.cs`.
- `Service`: backend API the UI calls, expected under `GeodeticDatumHostURL + "GeodeticDatum/api/"`.

NuGet packages (selected):
- `MudBlazor`: UI components and theming.
- `OSDC.UnitConversion.DrillingRazorMudComponents`: unit-aware inputs and adornments.
- `OSDC.DotnetLibraries.General.DataManagement`: common utilities.

Runtime behavior:
- `Program.cs` sets `UsePathBase("/GeodeticDatum/webapp")` and reads `GeodeticDatumHostURL` / `UnitConversionHostURL` into `WebApp.Configuration`.
- `Shared/APIUtils.cs` configures `HttpClient` base addresses and constructs the generated API client.

## Integration With the Solution

- Calls the `Service` endpoints at `/GeodeticDatum/api/...` using the generated client.
- Uses the shared model generated by `ModelSharedOut` (stays in sync with the Service OpenAPI).
- Complements the `Model` project by visualizing and operating on its data via the Service.
